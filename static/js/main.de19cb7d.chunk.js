(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{71:function(e,t,n){e.exports=n(84)},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var a=n(8),o=n.n(a),s=n(38),i=n.n(s),r=(n(76),n(19)),l=n(29),c=n(21),d=n(16),u=n(22),m=(n(77),n(40)),f=(n(78),n(93)),h=n(61),p=n(1),g=n(10),v=n(25),b=n(94),w=n(92),y=function(){function e(){Object(r.a)(this,e)}return Object(l.a)(e,[{key:"mouseDown",value:function(e,t){if(0===t.selectedItems.connectors.length)if(t.selectedItems.nodes.length>0&&"#3583ba"!==t.selectedItems.nodes[0].style.fill){for(var n in t.selectedItems.nodes)t.selectedItems.nodes[n].style.fill="#3583ba",t.selectedItems.nodes[n].addInfo[0].eventtype="S";e.source=t.nodes[t.nodes.length-1],e.sourceWrapper=e.source.wrapper,this.inAction=!0}else t.selectedItems.nodes[0].style.fill="#ffeec7",t.selectedItems.nodes[0].addInfo[0].eventtype="N",e.source=t.nodes[t.nodes.length-1],e.sourceWrapper=e.source.wrapper,this.inAction=!0}}]),e}(),E=function(){function e(){Object(r.a)(this,e)}return Object(l.a)(e,[{key:"mouseDown",value:function(e,t){if(0===t.selectedItems.connectors.length)if(t.selectedItems.nodes.length>0&&"#F45342"!==t.selectedItems.nodes[0].style.fill){for(var n in t.selectedItems.nodes)t.selectedItems.nodes[n].style.fill="#F45342",t.selectedItems.nodes[n].addInfo[0].eventtype="O";e.source=t.nodes[t.nodes.length-1],e.sourceWrapper=e.source.wrapper,this.inAction=!0}else t.selectedItems.nodes[0].style.fill="#ffeec7",t.selectedItems.nodes[0].addInfo[0].eventtype="N",e.source=t.nodes[t.nodes.length-1],e.sourceWrapper=e.source.wrapper,this.inAction=!0}}]),e}(),O=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).getAnnotationsAsEvents=function(){var e=new FormData;console.log(n.state.nodes.length),e.append("size",String(n.state.nodes.length)),fetch("/GetAnnots",{method:"POST",body:e,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":!0}}).then(function(e){return e.json()}).then(function(e){var t=n.convertNodes(e);n.addedEvents=t,n.new_annots=!0})},n.pagenum=e.pagenum,n.file=e.file,console.log(n.file),n.hasPdf=e.hasPdf,n.state={nodes:[{id:"n1",offsetX:280,offsetY:250,annotations:[{content:""}],addInfo:[{eventtype:""}]},{id:"n2",offsetX:280,offsetY:110,annotations:[{content:""}],addInfo:[{eventtype:""}]}],connectors:[{id:"connector1",sourceID:"n1",targetID:"n2"}]},n.addedEvents=null,n.nodes=null,n.connectors=[],n.new_annots=!1,n.downloadCSV=n.downloadCSV.bind(Object(m.a)(n)),n.saveAsFile=n.saveAsFile.bind(Object(m.a)(n)),n.getGraphRep=n.getGraphRep.bind(Object(m.a)(n)),n.convertNodes=n.convertNodes.bind(Object(m.a)(n)),n.convertConnectors=n.convertConnectors.bind(Object(m.a)(n)),n.getPorts=n.getPorts.bind(Object(m.a)(n)),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){void 0!==this.file&&this.getGraphRep()}},{key:"getPorts",value:function(e){return[{id:"port1",shape:"Circle",offset:{x:0,y:.5}},{id:"port2",shape:"Circle",offset:{x:.5,y:1}},{id:"port3",shape:"Circle",offset:{x:1,y:.5}},{id:"port4",shape:"Circle",offset:{x:.5,y:0}}]}},{key:"convertNodes",value:function(e){var t=[];for(var n in e)t.push({id:String(e[n].Name),annotations:[{content:String(e[n].Content)}],addInfo:[{eventtype:String(e[n].eventtype)}]});return t}},{key:"convertConnectors",value:function(e){var t=[];for(var n in e)null!==e[n]&&t.push({id:String(e[n].id),sourceID:String(e[n].sourceID),targetID:String(e[n].targetID),annotations:[{content:String(e[n].content)}]});return t}},{key:"getGraphRep",value:function(){var e=this,t=new FormData;t.append("pagenum",this.pagenum),t.append("file",this.file),fetch("/GetGraph",{method:"POST",body:t,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":!0}}).then(function(e){return e.json()}).then(function(t){console.log(e.state.data),console.log(t.nodes[0].Name),console.log(t.connectors);var n=e.convertNodes(t.nodes),a=e.convertConnectors(t.connectors);console.log(n),e.setState({nodes:n,connectors:a})})}},{key:"downloadCSV",value:function(){var e=this,t=new FormData;t.append("nodes",JSON.stringify(this.state.nodes)),t.append("connectors",JSON.stringify(this.state.connectors)),fetch("/downloadcsv",{method:"POST",body:t,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":!0}}).then(function(t){t.body.getReader().read().then(function(t){t.done;var n=t.value;e.saveAsFile(new TextDecoder("utf-8").decode(n),"result.csv")})})}},{key:"saveAsFile",value:function(e,t){var n=new Blob([e],{type:"text/csv"}),a=URL.createObjectURL(n),o=document.createElement("a");o.href=a,o.download=t,o.click()}},{key:"render",value:function(){var e,t=this,n=[{name:"solution",pathData:"M60.3,18H27.5c-3,0-5.5,2.4-5.5,5.5v38.2h5.5V23.5h32.7V18z M68.5,28.9h-30c-3, 0-5.5,2.4-5.5,5.5v38.2c0,3,2.4,5.5,5.5,5.5h30c3,0,5.5-2.4,5.5-5.5V34.4C73.9,31.4,71.5,28.9,68.5,28.9z M68.5,72.5h-30V34.4h30V72.5z",visible:!0,offset:1,side:"Right",pathColor:"white",margin:{top:0,bottom:0,left:0,right:100},backgroundColor:"blue"},{name:"observation",pathData:"M60.3,18H27.5c-3,0-5.5,2.4-5.5,5.5v38.2h5.5V23.5h32.7V18z M68.5,28.9h-30c-3, 0-5.5,2.4-5.5,5.5v38.2c0,3,2.4,5.5,5.5,5.5h30c3,0,5.5-2.4,5.5-5.5V34.4C73.9,31.4,71.5,28.9,68.5,28.9z M68.5,72.5h-30V34.4h30V72.5z",visible:!0,offset:1,side:"Left",pathColor:"white",margin:{top:10,bottom:10,left:100,right:10},backgroundColor:"red"}];return a.createElement("div",{className:"control-pane font-size:larger"},a.createElement("div",{className:"control-section"},a.createElement(function(){return t.hasPdf?a.createElement("button",{className:"btn btn-secondary",onClick:function(){t.getAnnotationsAsEvents()}},"Add PDF Annotations"):a.createElement("div",null)},null),a.createElement("button",{className:"btn btn-success",onClick:function(){var n=[],a=[];for(var o in e.nodes)n.push({id:String(e.nodes[o].id),annotations:[{content:String(e.nodes[o].annotations[0].content)}],addInfo:[{eventtype:String(e.nodes[o].addInfo[0].eventtype)}]});if(t.new_annots)for(var s in t.addedEvents)n.push(t.addedEvents[s]);for(var i in console.log(n),e.connectors)a.push({id:String(e.connectors[i].id),sourceID:String(e.connectors[i].sourceID),targetID:String(e.connectors[i].targetID),annotations:[{content:String(e.connectors[i].annotations[0].content)}]});t.setState({nodes:n,connectors:a}),console.log(t.state.nodes),console.log(t.state.connectors),t.new_annots=!1}},"Apply Edits (Refresh Diagram)"),a.createElement("button",{type:"submit",className:"btn btn-primary",onClick:this.downloadCSV},"Get Results"),a.createElement(f.a,{id:"toolbar",items:[{tooltipText:"Delete",prefixIcon:"e-ddb-crudicons e-delete",id:"Delete",text:"Delete"}],clicked:function(n){var a;if(e.selectedItems.nodes.length>0&&(a=e.selectedItems.nodes[0]),e.selectedItems.connectors.length>0&&(a=e.selectedItems.connectors[0]),a)switch(n.item.tooltipText){case"Delete":e.remove(a),e.doLayout();var o={id:a.id,annotations:a.annotations,addInfo:a.addInfo},s=t.state.nodes.indexOf(o);console.log(s),t.state.nodes.splice(s,1)}}}),a.createElement("div",{className:"sb-mobile-palette-bar"},a.createElement("div",{id:"palette-icon",style:{float:"right",role:"button"},className:"e-ddb-icons1 e-toggle-palette"})),a.createElement("div",{id:"palette-space",className:"sb-mobile-palette"},a.createElement(h.b,{id:"symbolpalette",expandMode:"Multiple",palettes:[{id:"flow",expanded:!0,symbols:[{id:"Process",shape:{type:"Flow",shape:"Process"}}],iconCss:"e-diagram-icons1 e-diagram-flow",title:"Add Events"},{id:"connectors",expanded:!0,symbols:[{id:"Link1",type:"Orthogonal",sourcePoint:{x:0,y:0},targetPoint:{x:60,y:60},targetDecorator:{shape:"Arrow"},style:{strokeWidth:1}}],iconCss:"e-diagram-icons1 e-diagram-connector",title:"Add Connectors"}],width:"20%%",height:"700px",symbolHeight:60,symbolWidth:60,getNodeDefaults:function(e){"Process"===e.id&&(e.width=80,e.height=40)},symbolMargin:{left:0,right:0,top:0,bottom:0},getSymbolInfo:function(e){return{fit:!0}}})),a.createElement("div",{id:"diagram-space",className:"sb-mobile-diagram"},a.createElement(h.a,{id:"diagram",ref:function(t){return e=t},nodes:this.state.nodes,connectors:this.state.connectors,width:"100%",height:750,selectedItems:{userHandles:n},snapSettings:{constraints:p.q.HideLines},getCustomTool:function(t){var a;if(0===e.selectedItems.connectors.length&&0!==e.selectedItems.nodes.length)return"solution"===t?a=(new y).mouseDown(e.commandHandler,e):"observation"===t&&(a=(new E).mouseDown(e.commandHandler,e)),a;n[1].visible=!1},layout:{type:"HierarchicalTree",horizontalSpacing:40,verticalSpacing:40,orientation:"TopToBottom",enableAnimation:!0,margin:{left:10,right:0,top:50,bottom:0}},getNodeDefaults:function(e){if(void 0===e.addInfo){e.addInfo=[{eventtype:"N"}]}void 0===e.annotations&&(e.annotations=[{content:""}]);return 0===e.annotations.length&&(e.annotations=[{content:""}]),e.width=120,e.height=100,e.shape={type:"Basic",shape:"Rectangle",cornerRadius:7},e.style.fill=void 0===e.addInfo?"#ffeec7":"S"===e.addInfo[0].eventtype?"#3583ba":"O"===e.addInfo[0].eventtype?"#F45342":"#ffeec7",e.ports=t.getPorts(e),e},getConnectorDefaults:function(e){if(-1!==e.id.indexOf("connector")){e.type="Orthogonal",e.cornerRadius=7,e.targetDecorator.height=10,e.targetDecorator.width=10,e.style.strokeColor="#6d6d6d";0!==e.annotations.length&&void 0!==e.annotations||(e.annotations=[{content:""}])}else console.log(e),e=null},dataSourceSettings:{id:"id"},dragEnter:function(e){var t=e.element;if(t instanceof Node){console.log(t);var n=t.width,a=t.height,o=100/t.width;t.width=100,t.height*=o,t.offsetX+=(t.width-n)/2,t.offsetY+=(t.height-a)/2,t.style={fill:"#357BD2",strokeColor:"white"}}t instanceof g.b&&(t.annotations=[{content:""}])}},a.createElement(v.c,{services:[b.a,w.a]})))))}}]),t}(a.Component),C=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).file=e.file,n.viewer=o.a.createRef(),n.docViewer=null,n.annotManager=null,n.instance=null,n.initialPage=e.pagenum,console.log(n.initialPage),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.WebViewer({path:window.sahar+"lib",initialDoc:""},this.viewer.current).then(function(t){e.instance=t,e.docViewer=t.docViewer,e.annotManager=t.annotManager,t.loadDocument(e.file),t.enableFilePicker(),e.docViewer.on("annotationsLoaded",function(){console.log("annotations loaded");var t=e.annotManager.getAnnotationsList();for(var n in e.annotManager.deleteAnnotations(e.annotManager.getAnnotationsList()),t)console.log(t[n])}),e.annotManager.on("annotationChanged",function(e,t,n){if("add"===n){console.log(t[0].getContents());var a=new FormData;a.append("event",t[0].getContents()),fetch("/addEventFromPDF",{method:"POST",body:a,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":!0}}).then(function(e){return e.json()}).then()}else if("modify"===n)console.log("this change modified annotations");else if("delete"===n){var o=new FormData;o.append("event",t[0].getContents()),fetch("/removeEventFromPDF",{method:"POST",body:o,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":!0}})}}),e.docViewer.on("documentLoaded",function(){for(var t=1;t<e.initialPage;t++)e.instance.goToNextPage()})})}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"webviewer",style:{height:"750px"},ref:this.viewer}))}}]),t}(o.a.Component),I=n(45),j=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).myViewer=o.a.createRef(),n.state={pagenum:e.location.state.pagenum,file:e.location.state.file},window.console.log(n.state),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=Object(I.f)(function(e){var t=e.history;return o.a.createElement("img",{src:"https://pbs.twimg.com/media/Dn88s1aWsAAF4fH.png",width:"200",height:"150",alt:"",onClick:function(){t.push({pathname:"/"}),window.location.reload()}})}),n=Object(I.f)(function(t){var n=t.history;return o.a.createElement("button",{className:"btn btn-primary",onClick:function(){var t=parseInt(e.state.pagenum)+1;console.log(t),console.log(e.file),n.push({pathname:"/parser",state:{pagenum:t,file:e.state.file}}),window.location.reload()}},"Parse Next Page")});return o.a.createElement("div",{className:"container-fluid"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"container"},o.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},o.a.createElement(t,null),o.a.createElement("h3",{className:"navbar-brand"},"Aquant-Fault Tree Parser"),o.a.createElement("h6",null,"Please Label Events. Red = Observation, Blue = Solution."),o.a.createElement(n,null)))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-lg-7"},o.a.createElement(O,{file:this.state.file,pagenum:this.state.pagenum,hasPdf:!0})),o.a.createElement("div",{className:"col-lg-5"},o.a.createElement(C,{file:this.state.file,pagenum:this.state.pagenum}))))}}]),t}(o.a.Component),A=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=Object(I.f)(function(e){var t=e.history;return o.a.createElement("img",{src:"https://pbs.twimg.com/media/Dn88s1aWsAAF4fH.png",width:"200",height:"150",alt:"",onClick:function(){t.push({pathname:"/"}),window.location.reload()}})});return o.a.createElement("div",{className:"container-fluid"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"container"},o.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},o.a.createElement(e,null),o.a.createElement("h3",{className:"navbar-brand"},"Aquant-Fault Tree Parser"),o.a.createElement("h6",null,"Please Label Events. Red = Observation, Blue = Solution.")))),o.a.createElement(O,{hasPdf:!1}))}}]),t}(o.a.Component),N=n(44),D=n(69),S=n.n(D),k=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).pagenum=null,n.file=null,n.handleUpload=n.handleUpload.bind(Object(m.a)(n)),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){S.a.init()}},{key:"handleUpload",value:function(){var e=this;this.file=this.uploadInput.files[0],this.pagenum=document.getElementById("pagenum").value;var t=new FormData;t.append("file",this.file),t.append("pagenum",this.pagenum),console.log(t),fetch("/upload",{method:"POST",body:t,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":!0}}).then(function(e){return e.json()}).then(function(t){e.setState({data:t})})}},{key:"render",value:function(){var e=this,t=Object(I.f)(function(t){var n=t.history;return o.a.createElement("button",{type:"submit",className:"btn btn-primary p-3",onClick:function(){e.file=e.uploadInput.files[0],e.pagenum=document.getElementById("pagenum").value,n.push({pathname:"/parser/",state:{pagenum:e.pagenum,file:e.file}})}},"Submit")});return o.a.createElement("form",{autoComplete:"off"},o.a.createElement("div",{class:"custom-file"},o.a.createElement("input",{ref:function(t){e.uploadInput=t},type:"file",class:"custom-file-input file-name",id:"customFile"}),o.a.createElement("label",{class:"custom-file-label",for:"customFile"},"Choose file")),o.a.createElement("input",{id:"pagenum",className:"form-control form-control-lg",type:"text",placeholder:"Enter starting PDF page."}),o.a.createElement("button",{type:"button",className:"btn btn-success p-3",onClick:function(){e.handleUpload()}},"Apply"),o.a.createElement(t,null))}}]),t}(o.a.Component),P=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).filename=null,n.pagenum=null,n.fileToBeSent=null,n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"routeChangeToParser",value:function(){return o.a.createElement(N.a,{path:"/parser",component:j})}},{key:"render",value:function(){var e=Object(I.f)(function(e){var t=e.history;return o.a.createElement("button",{className:"btn btn-primary",onClick:function(){t.push({pathname:"/builder/"})}},"Start from Scratch!")});return o.a.createElement("div",{className:"jumbotron"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-m-7 p-3"},o.a.createElement("h1",{className:"display-4"},"Aquant Fault Tree Evaluator"),o.a.createElement("p",{className:"lead"},"To run: Upload Troubleshooting Manual or Start from scratch!")),o.a.createElement("img",{src:"https://pbs.twimg.com/media/Dn88s1aWsAAF4fH.png",width:"200",height:"150",alt:""})),o.a.createElement("hr",{className:"my-4"}),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-m-6"},o.a.createElement(k,null)),o.a.createElement("div",{className:"col-m-6 p-3"},o.a.createElement(e,null),o.a.createElement(N.a,{path:"/builder/",component:A}))))}}]),t}(a.Component),F=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(N.a,null,o.a.createElement(I.c,null,o.a.createElement(I.a,{exact:!0,path:"/",component:P}),o.a.createElement(I.a,{path:"/parser/",component:j}),o.a.createElement(I.a,{path:"/builder/",component:A})))}}]),t}(o.a.Component);n(83),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[71,1,2]]]);
//# sourceMappingURL=main.de19cb7d.chunk.js.map